{% assign app_url = 'https://leadcod.com' %}

{% # theme-check-disable RemoteAsset %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=Nunito:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
{% # theme-check-enable RemoteAsset %}
{{ 'font-awesome.css' | asset_url | stylesheet_tag }}

<script>
(function() {
  'use strict';
  window.LEADCOD_CONFIG = window.LEADCOD_CONFIG || {};
  window.LEADCOD_CONFIG.APP_URL = '{{ app_url }}';
  window.LEADCOD_CONFIG.API_BASE_URL = '{{ app_url }}/api';
  window.LEADCOD_CONFIG.getApiUrl = function(endpoint) {
    const baseUrl = this.API_BASE_URL.replace(/\/$/, '');
    const path = endpoint.replace(/^\//, '');
    return baseUrl + '/' + path;
  };
})();
</script>

<script>
(function() {
  window.LEADCOD_PIXEL_DATA = window.LEADCOD_PIXEL_DATA || {};
  window.LEADCOD_PIXEL_DATA.shopUrl = '{{ shop.domain }}';
  {% if product %}
  window.LEADCOD_PIXEL_DATA.productData = {
    id: {{ product.id | json }},
    title: {{ product.title | json }},
    variant_id: {{ product.selected_or_first_available_variant.id | json }},
    variants: {{ product.variants | json }},
    price: {{ product.selected_or_first_available_variant.price | json }},
    currency: {{ cart.currency.iso_code | default: 'DZD' | json }}
  };
  {% else %}
  window.LEADCOD_PIXEL_DATA.productData = null;
  {% endif %}
})();
</script>
<script src="{{ 'leadcod-facebook-pixel.js' | asset_url }}" defer></script>

<div id="leadcod-form-{{ block.id }}" class="leadcod-form-container">
  <div class="leadcod-form-loading">جاري تحميل النموذج...</div>
</div>

<script src="{{ 'leadcod-form-utils.js' | asset_url }}" defer></script>
<script src="{{ 'leadcod-form-fields.js' | asset_url }}" defer></script>

<script>
(function() {
  window.LEADCOD_FORM_INIT_DATA = window.LEADCOD_FORM_INIT_DATA || {};
  window.LEADCOD_FORM_INIT_DATA.blockId = '{{ block.id }}';
  window.LEADCOD_FORM_INIT_DATA.shopUrl = '{{ shop.domain }}';
  {% if product %}
  window.LEADCOD_FORM_INIT_DATA.productVariants = {{ product.variants | json }};
  window.LEADCOD_FORM_INIT_DATA.defaultVariantId = {{ product.selected_or_first_available_variant.id }};
  window.LEADCOD_FORM_INIT_DATA.product = {{ product | json }};
  {% else %}
  window.LEADCOD_FORM_INIT_DATA.productVariants = [];
  window.LEADCOD_FORM_INIT_DATA.defaultVariantId = null;
  window.LEADCOD_FORM_INIT_DATA.product = {};
  {% endif %}
})();
</script>
<script src="{{ 'leadcod-form-init.js' | asset_url }}" defer></script>

{{ 'leadcod-form.css' | asset_url | stylesheet_tag }}

{% schema %}
{
  "name": "Leadcod Form",
  "target": "section"
}
{% endschema %}
